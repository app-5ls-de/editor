---
layout: bare
---
<h1 id="local"><a href="/local">Local</a></h1>
<hr>
<h1>Shared</h1>
<div style="padding-left: 2rem;">
    <style>
        button {
            padding: 0;
            background: 0 0;
            border: none;
            cursor: pointer;
            display: inline-block;
            min-height: 24px;
            padding: 5px 8px;
            min-width: 28px;
        }

        #list>div {
            min-height: 2rem;
        }

        #list>div>a {
            display: inline-block;
            width: 13rem;
            margin-right: 1rem;
            font-size: 1.3rem;
        }

        svg {
            width: 2rem;
        }

        span {
            display: inline-block;
            vertical-align: middle;
            height: min-content;
            border: 1px solid #ccc;
        }
    </style>
    <div id="list">
    </div>
</div>
<hr>
<h1>New</h1>
<a href="/new?auto">create new share</a>
<script>
    var list = document.getElementById("list")

    function rename(id) {
        console.log(id)
        let element = JSON.parse(localStorage[id])
        let title = element.private.title
        if (!title) title = element.private.id
        var newTitle = prompt("Please enter the new title:", element.private.id)
        if (newTitle != null && newTitle != "") {
            element.private.title = newTitle
            localStorage.setItem(id, JSON.stringify(element))
            document.getElementById(id).firstElementChild.innerText = newTitle
        }
    }

    function createElement(element) {
        let div = document.createElement("div")
        let a = document.createElement("a")
        let span = document.createElement("span")
        let button_delete = document.createElement("button")
        let button_rename = document.createElement("button")

        button_delete.innerHTML = '<svg viewBox="0 0 64 64"><path d="M17.586,46.414C17.977,46.805,18.488,47,19,47s1.023-0.195,1.414-0.586L32,34.828l11.586,11.586 C43.977,46.805,44.488,47,45,47s1.023-0.195,1.414-0.586c0.781-0.781,0.781-2.047,0-2.828L34.828,32l11.586-11.586 c0.781-0.781,0.781-2.047,0-2.828c-0.781-0.781-2.047-0.781-2.828,0L32,29.172L20.414,17.586c-0.781-0.781-2.047-0.781-2.828,0 c-0.781,0.781-0.781,2.047,0,2.828L29.172,32L17.586,43.586C16.805,44.367,16.805,45.633,17.586,46.414z"/><path d="M32,64c8.547,0,16.583-3.329,22.626-9.373C60.671,48.583,64,40.547,64,32s-3.329-16.583-9.374-22.626 C48.583,3.329,40.547,0,32,0S15.417,3.329,9.374,9.373C3.329,15.417,0,23.453,0,32s3.329,16.583,9.374,22.626 C15.417,60.671,23.453,64,32,64z M12.202,12.202C17.49,6.913,24.521,4,32,4s14.51,2.913,19.798,8.202C57.087,17.49,60,24.521,60,32 s-2.913,14.51-8.202,19.798C46.51,57.087,39.479,60,32,60s-14.51-2.913-19.798-8.202C6.913,46.51,4,39.479,4,32 S6.913,17.49,12.202,12.202z"/></svg>'
        button_delete.onclick = function () {
            localStorage.removeItem(element.private.id)
            document.getElementById(element.private.id).remove()
        }

        button_rename.innerHTML = '<svg viewBox="0 0 512 512"><path d="m455.1,137.9l-32.4,32.4-81-81.1 32.4-32.4c6.6-6.6 18.1-6.6 24.7,0l56.3,56.4c6.8,6.8 6.8,17.9 0,24.7zm-270.7,271l-81-81.1 209.4-209.7 81,81.1-209.4,209.7zm-99.7-42l60.6,60.7-84.4,23.8 23.8-84.5zm399.3-282.6l-56.3-56.4c-11-11-50.7-31.8-82.4,0l-285.3,285.5c-2.5,2.5-4.3,5.5-5.2,8.9l-43,153.1c-2,7.1 0.1,14.7 5.2,20 5.2,5.3 15.6,6.2 20,5.2l153-43.1c3.4-0.9 6.4-2.7 8.9-5.2l285.1-285.5c22.7-22.7 22.7-59.7 0-82.5z"/></svg>'
        button_rename.onclick = function () {
            rename(element.private.id)
        }

        if (element.private.title) {
            a.innerHTML = element.private.title
        } else {
            a.innerHTML = element.private.id
        }

        div.id = element.private.id

        a.href = location.origin + "/shared?id=" + element.private.id
        div.append(a)
        span.append(button_rename)
        span.append(button_delete)
        div.append(span)
        return div
    }

    if (localStorage.hasOwnProperty("local") && localStorage.local) {
        let button = document.createElement("button")
        button.innerHTML = '<svg viewBox="0 0 64 64"><path d="M17.586,46.414C17.977,46.805,18.488,47,19,47s1.023-0.195,1.414-0.586L32,34.828l11.586,11.586 C43.977,46.805,44.488,47,45,47s1.023-0.195,1.414-0.586c0.781-0.781,0.781-2.047,0-2.828L34.828,32l11.586-11.586 c0.781-0.781,0.781-2.047,0-2.828c-0.781-0.781-2.047-0.781-2.828,0L32,29.172L20.414,17.586c-0.781-0.781-2.047-0.781-2.828,0 c-0.781,0.781-0.781,2.047,0,2.828L29.172,32L17.586,43.586C16.805,44.367,16.805,45.633,17.586,46.414z"/><path d="M32,64c8.547,0,16.583-3.329,22.626-9.373C60.671,48.583,64,40.547,64,32s-3.329-16.583-9.374-22.626 C48.583,3.329,40.547,0,32,0S15.417,3.329,9.374,9.373C3.329,15.417,0,23.453,0,32s3.329,16.583,9.374,22.626 C15.417,60.671,23.453,64,32,64z M12.202,12.202C17.49,6.913,24.521,4,32,4s14.51,2.913,19.798,8.202C57.087,17.49,60,24.521,60,32 s-2.913,14.51-8.202,19.798C46.51,57.087,39.479,60,32,60s-14.51-2.913-19.798-8.202C6.913,46.51,4,39.479,4,32 S6.913,17.49,12.202,12.202z"/></svg>'
        button.onclick = function () {
            localStorage.removeItem("local")
            location.reload();
        }
        document.getElementById("local").append(button)
    }

    for (const key in localStorage) {
        if (localStorage.hasOwnProperty(key) && key != "local" && key != "null" && key != "settings") {
            let element
            try {
                element = JSON.parse(localStorage[key])
            } catch (error) {
                //console.log(error)
                localStorage.removeItem(key)
                continue
            }
            console.log(element)
            if (!element || !element.private || !element.private.id || key != element.private.id) {
                localStorage.removeItem(key)
                continue
            }


            list.append(createElement(element))

        }
    }
</script>